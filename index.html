<!-- MODAL DE FLUXO E CADASTRO -->
<div id="modal-flow" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closeModal('modal-flow')">&times;</span>
        
        <!-- PASSO 1: ESPELHO DA DOR (Dinâmico) -->
        <div id="step-1" class="step-view">
            <p class="modal-intro" id="modal-intro-text">Texto de abertura...</p>
            <h3 id="modal-title-pain">Título do Perfil</h3>
            <ul id="modal-bullets-pain" class="pain-list"></ul>
            <p class="modal-turn" id="modal-turn-text">Frase de virada...</p>
            <button id="btn-to-step-2" class="cta-button cta-primary full-width" onclick="goToStep2()">
                Quero resolver isso
            </button>
        </div>

        <!-- PASSO 2: FORMULÁRIO DE CADASTRO -->
        <div id="step-2" class="step-view" style="display: none;">
            <div class="form-header">
                <h3>Cadastro Beta Fechado</h3>
                <p>Garanta sua vaga de pioneiro.</p>
            </div>

            <form id="beta-form" name="beta-signup" method="POST" data-netlify="true" onsubmit="submitForm(event)">
                <!-- Configuração Netlify -->
                <input type="hidden" name="form-name" value="beta-signup" />
                
                <!-- Identifica o perfil (Motorista, Chapa...) -->
                <input type="hidden" id="input-perfil" name="perfil" value="">
                
                <!-- RASTREAMENTO: Quem indicou essa pessoa? (Capturado da URL) -->
                <input type="hidden" id="input-indicado-por" name="indicado_por" value="">

                <div class="form-group">
                    <label>Nome completo</label>
                    <input type="text" name="nome" required placeholder="Seu nome">
                </div>

                <div class="form-group">
                    <label>WhatsApp</label>
                    <input type="tel" name="whatsapp" required placeholder="(XX) XXXXX-XXXX" id="phone-input">
                </div>

                <button type="submit" class="cta-button cta-primary full-width">
                    Entrar para o Beta Loomper
                </button>

                <p class="micro-trust">
                    <i class="fas fa-lock"></i> Seus dados são usados apenas para contato oficial.
                </p>
            </form>
        </div>

        <!-- PASSO 3: SUCESSO & MGM (Member Get Member) -->
        <div id="step-success" class="step-view" style="display: none; text-align: center;">
            <div style="margin-bottom: 20px;">
                <i class="fas fa-check-circle" style="font-size: 3.5rem; color: #d4af37;"></i>
            </div>
            
            <h3 style="color: #fff; margin-bottom: 10px;">Bem-vindo, Pioneiro!</h3>
            <p style="color: #ccc; margin-bottom: 25px; line-height: 1.4;">
                Seu cadastro foi confirmado. Agora, aumente sua moral convidando parceiros da estrada.
            </p>
            
            <!-- Caixa de Indicação -->
            <div class="referral-box" style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 8px; border: 1px dashed #555; margin-bottom: 20px;">
                <p style="font-size: 0.8rem; color: #d4af37; margin-bottom: 8px; font-weight: bold; text-transform: uppercase;">Seu Link de Convite:</p>
                
                <!-- Input com o Link Gerado -->
                <input type="text" id="my-referral-link" readonly 
                       style="width: 100%; background: #000; color: #fff; border: 1px solid #333; padding: 12px; font-size: 0.9rem; text-align: center; border-radius: 4px; margin-bottom: 15px;">
                
                <!-- Botão de Compartilhar -->
                <button onclick="shareOnWhatsapp()" class="cta-button full-width" 
                        style="background: #25d366; color: #fff; border: none; font-weight: bold; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    <i class="fab fa-whatsapp" style="font-size: 1.2rem;"></i> Enviar no Zap
                </button>
            </div>

            <p style="font-size: 0.8rem; color: #666;">
                Quem mais indica ganha prioridade no lançamento oficial.
            </p>
        </div>

    </div>
</div>
